
/*file=/nickpress.com/javascript/modules/social_module/social.js */
$Crabapple.TriforceModule_social = function() {};

$Crabapple.extend($Crabapple.TriforceModule, $Crabapple.TriforceModule_social, {
	viewName: '$Crabapple.TriforceView_m001_v1',

	initializeView: function () {
		var viewName = this.viewName.split('.'),
			feed = JSON.parse(this.feedResponse.content),
			self = this;

		this.view = new window[viewName[0]][viewName[1]]();

		this.view.init(this.moduleElement);
		
		$NickPress.TwitterFeed.init({'tweetUrl': feed.content.content['twitter'].socialProxyUrl}, function (tweets) {
	            var newTweets = [];
	            for (var i in tweets) {
	            	if (tweets[i].text != null) newTweets[newTweets.length] = tweets[i];
	            }
				feed.content.tweets = newTweets;

	            self.view.generateCoreElement('social info_module');
	    		self.view.templateContent('social', feed);
	    		self.moduleElement = self.view.setOutput();

	    		facebookInit();
	    		self.attachEvents();
        });
	},

    attachEvents: function () {
    	this.moduleElement.find('.social > .header').click(function() {
    		$(this).parent().toggleClass('expanded');
    	});
    }
});
/*endFile*/
